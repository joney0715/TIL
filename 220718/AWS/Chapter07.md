## **7-2 CloudWatch**

- CloudWatch는 AWS 내부 및 외부 리소스의 수치 성능 지표를 수집하고, 검색하고 그래프로 만들 수 있는 지표 저장소 역할 수행
- 모든 리소스는 CloudWatch에 CPU사용률, EBS볼륨 읽기/쓰기 IOPS, S3 버킷 크기, DynamoDB 읽기/ 쓰기 용량 단위 사용량 등의 지표를 자동으로 보냄



### **CloudWatch 지표**

- CloudWatch는 지표를 네임 스페이스로 구성
- AWS 서비스에서 나온 지표는 AWS 네임 스페이스에 저장
- AWS / 서비스 형식으로 쉽게 지표를 분류 가능
- 네임 스페이스는 지표의 컨테이너이며 유사한 이름의 다른 지표와 혼동하지 않게 해줌
  - CloudWatch는 RDS의 WriteOps 지표는 AWS/RDS 네임 스페이스에 저장
- 사용자 지정 지표를 통해 사용자 지정 네임 스페이스를 생성 가능



- 지표는 변수로 작동하며 시간 순서별로 모아놓은 데이터 포인트를 포함
- 각 데이터 포인트에는 타임스탬프, 값, 선택적 측정 단위 포함
- 각 지표는 네임 스페이스, 이름으로 고유하게 정의하며 차원을 정의 가능
- 차원은 같은 이름과 네임 스페이스를 가진 지표를 각각 구분하는 이름-값 형태의 페어로 구성



#### 기본 모니터링과 세부 모니터링

- 대부분의 서비스는 기본 모니터링을 지원하고 일부 서비스는 기본 모니터링과 세부 모니터링을 지원
- 기본 모니터링은 5분마다 CloudWatch에 지표를 보냄(EC2는 기본모니터링을, EBS는 gp2 볼륨을 대상으로 기본 모니터링 사용)
- EC2는 1분마다 통계를 수집하지만 5분 동안의 평균 데이터만을 CloudWatch에 보냄
- 세부 모니터링을 사용하는 서비스는 매분 CloudWatch에 지표를 게시
  - EC2, RDS, DynamoDB, ECS, Lambda 등 70개 이상의 서비스가 세부 모니터링을 지원



#### 일반 정밀도 지표와 고정밀도 지표

- AWS 서비스에서 생성된 지표는 1분 이상의 타임스탬프 정밀도를 지님
- CloudWatch는 최대 1초 단위로 사용자 정의 지표를 저장 가능(1분 미만의 정밀도 지표를 고정밀 지표라 부름)
- PutMetricData API를 사용해서 사용자 정의 지표를 자성 가능
  - 최대 2주 전부터 2시간 이후까지 타임스탬프를 지정 가능(지정을 않하면 UTC로 지표를 받은 시간을 기준으로 만듬)



#### 만료

- CloudWatch에서는 지표가 삭제되지 않고 자동으로 만료
- 만료 시점은 정밀도 수준에 따라 달라짐



### 지표 그래프 작성

- CloudWatch를 사용하면 시간 경과에 따라 데이터 포인트를 그래프로 표시해 지표를 시각화 가능

- 일정 기간 데이터 포인트의 통계 분석을 수행하고 결과를 시계열 그래프로 나타냄

  - 합계 : 해당 기간 모든 데이터 포인트의 합계
  - 최소 : 해당 기간 가장 낮은 데이터 포인트
  - 최대 : 해당 기간 가장 높은 데이터 포인트
  - 평균 : 해당 기간 모든 데이터 포인트 평균
  - 샘플 수 : 해당 기간 데이터 포인트 수
  - 백분율 : 지정된 백분율 데이터 포인트로 표시

   

### 지표 수식

- CloudWatch를 사용하면 지표를 이용해서 다양한 수학 함수르 실행하고 새로운 시계열 그래프 제작 가능
- 지표 데이터에 대한 더하기, 빼기, 곱하기, 나누기, 지수를 포함한 산술 함수를 사용해 여러 지표를 하나의 시계열로 결합